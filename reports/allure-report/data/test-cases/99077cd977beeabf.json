{"uid":"99077cd977beeabf","name":"test_reporting_export_this_page","fullName":"tests.test_reporting#test_reporting_export_this_page","historyId":"33a51106bf2e2b8502230901bcf37c62","time":{"start":1756822219970,"stop":1756822258771,"duration":38801},"status":"broken","statusMessage":"AttributeError: 'NoneType' object has no attribute 'strip'","statusTrace":"driver_with_downloads = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"f74db1fbcc35768946b11ef4fc5fe1a9\")>\n\n    def test_reporting_export_this_page(driver_with_downloads):\n        driver = driver_with_downloads\n        lp = LoginPage(driver)\n        r = Reporting(driver)\n        lp.do_login(Constant.USERNAME, Constant.PASSWORD)\n        db = DashBoard(driver)\n        db.element_displayed(db.DASHBOARD_TEXT)\n        db.click_reporting_ele()\n        r.set_date()\n        time.sleep(2)\n        r.do_click(r.REFRESH_BUTTON)\n        time.sleep(3)\n        r.scroll_to_element(r.CALL_DETAILS_TAB)\n        r.element_displayed(r.FIRST_CELL)\n        r.select_table_dropdown(\"100\")\n        r.element_displayed(r.FIRST_CELL)\n        r.scroll_to_element(r.TOTAL_CALLS)\n        r.do_click(r.EXPORT_BUTTON)\n        r.do_click(r.EXPORT_SUB_BUTTON)\n        time.sleep(2)\n        files = [f for f in os.listdir(driver.download_dir) if f.endswith(\".csv\")]\n        assert files, \"No CSV file found!\"\n        csv_file_path = os.path.join(driver.download_dir, files[0])\n        # read downloaded csv\n        csv_data = pd.read_csv(csv_file_path, sep=\",\", engine=\"python\")\n        # get UI dataframe\n>       ui_df = r.get_table_as_dataframe()\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ntests\\test_reporting.py:281: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npages\\reporting_page.py:78: in get_table_as_dataframe\n    return self.extract_table_as_dataframe(self.TABLE, exclude_last_n=2)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pages.reporting_page.Reporting object at 0x000001B578B430E0>\ntable_locator = ('xpath', \"//div[@class='overflow-x-auto max-w-full']\")\nexclude_last_n = 2, drop_sno = True, normalize_spaces = True\n\n    def extract_table_as_dataframe(self, table_locator, exclude_last_n=0, drop_sno=True, normalize_spaces=True):\n        table = self.driver.find_element(*table_locator)\n    \n        # Headers\n        headers = [h.text.strip() for h in table.find_elements(By.CSS_SELECTOR, \"thead th\")]\n        if exclude_last_n > 0:\n            headers = headers[:-exclude_last_n]\n    \n        # Rows\n        rows = table.find_elements(By.CSS_SELECTOR, \"tbody tr\")\n        data = []\n        for row in rows:\n            cols = row.find_elements(By.TAG_NAME, \"td\")\n>           row_data = [c.text.strip() for c in cols]\n                        ^^^^^^^^^^^^\nE           AttributeError: 'NoneType' object has no attribute 'strip'\n\npages\\base_page.py:56: AttributeError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"driver_with_downloads","time":{"start":1756822214259,"stop":1756822219970,"duration":5711},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"attachmentStep":false,"hasContent":false}],"afterStages":[{"name":"driver_with_downloads::0","time":{"start":1756822259012,"stop":1756822261089,"duration":2077},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"attachmentStep":false,"hasContent":false}],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_reporting"},{"name":"host","value":"DESKTOP-THM7RLI"},{"name":"thread","value":"8904-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_reporting"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"99077cd977beeabf.json","parameterValues":[]}